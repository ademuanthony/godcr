<!DOCTYPE html>
<html lang="en">
{{ template "html-head" }}
<body>
    <div class="body" data-controller="send">
        {{ template "header" }}
        <div class="content">
            <div class="container">
                <div data-target="send.errorMessage" class="alert alert-danger d-none"></div>
                <div data-target="send.successMessage" class="alert alert-success d-none"></div>
                <form method="POST" action="/send" id="send-form" data-target="send.form" novalidate>
                    {{ template "passphrase-modal" "send" }}
                    <div class="collapsible">
                        <div class="card">
                            <div class="card-body no-btm-pad">
                                <div class="row">
                                    <div class="col-sm-12 col-md-6">
                                        <div class="form-group">
                                            <label for="source-account">Source Account</label>	                                            
                                            <select data-target="send.sourceAccount" class="form-control" id="source-account" name="source-account" {{ if eq (len .accounts) 1 }}disabled{{ end }}>
                                            {{ range $account := .accounts }}	                                                
                                                <option value="{{ $account.Number }}">{{ $account.Name }} - {{ simpleBalance $account.Balance false }}</option>
                                            {{ end }}	                                              
                                            </select>	                                          
                                        </div>
                                        <div class="form-group form-check">
                                            <input data-action="click->send#toggleSpendUnconfirmed" data-target="send.spendUnconfirmed" type="checkbox" class="form-check-input" name="spend-unconfirmed" id="spend-unconfirmed">
                                            <label class="form-check-label" for="spend-unconfirmed">Spend unconfirmed</label>
                                        </div>
                                    </div>
                                </div>
                                <div data-target="send.destinations" id="destinations"></div>
                                <template data-target="send.destinationTemplate">
                                    <div class="row">
                                        <div class="col-md-6 col-sm-12">
                                            <div class="form-group">
                                                <label>Destination Address</label>
                                                <input data-target="send.address" type="text" class="form-control" name="destination-address" />
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-12">
                                            <div class="form-group">
                                                <label>Amount (DCR)</label>
                                                <input data-target="send.amount" data-action="keyup->send#validateAndRefreshPercentage" type="number" class="form-control amount" name="destination-amount" />
                                            </div>
                                        </div>
                                    </div>
                                </template>
                                
                                <div class="form-group">
                                    <button id="add-destinatvion-btn" type="button" data-action="click->send#newDestination" class="btn btn-sm btn-outline-secondary btn-primary">
                                        Add another address
                                    </button> &nbsp;&nbsp; 
                                    <button data-target="send.removeDestinationButton" data-action="click->send#removeDestination" id="remove-destination-btn" type="button" class="btn btn-sm btn-outline-secondary btn-primary d-none">
                                        Remove Last address
                                    </button>
                                </div>
                                <div class="form-group">
                                    <input data-target="send.useCustom" data-action="change->send#toggleUseCustom" type="checkbox" name="use-custom" id="use-custom" value="1" />
                                    <label for="use-custom">Select custom inputs</label>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div data-target="send.customTxRow" class="card-body collapse" id="custom-tx-row">
                                <div class="status">Fetching Unspent Outputs</div>
                                <div class="progress">
                                    <div data-target="send.progressBar" class="progress-bar" style="width: 0%"></div>
                                </div>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Address</th>
                                            <th>Amount</th>
                                            <th>Time</th>
                                            <th>Confirmations</th>
                                        </tr>
                                    </thead>
                                    <tbody data-target="send.customInputContent"></tbody>
                                </table>
                            </div>
                        </div>

                        <div id="changeOutputsCard" data-target="send.changeOutputsCard" class="d-none">
                            <div class="card">
                                  <div class="card-header" id="headingOne">
                                    <h5 class="mb-0">
                                      <button type="button" class="btn btn-link" data-toggle="collapse" 
                                      data-target="#automaticChangeOutputPnl" aria-controls="automaticChangeOutputPnl">
                                            Change Outputs
                                      </button>
                                    </h5>
                                  </div>
                              
                                  <div id="automaticChangeOutputPnl" data-target="send.changeOutputPnl" class="collapse" aria-labelledby="headingOne" data-parent="#changeOutputsCard">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-sm-12 form-inline">

                                                <label class="sr-only" for="numberOfChangeOutput">Number Of Change Outputs</label>
                                                <input data-target="send.numberOfChangeOutputs" type="text" class="form-control mb-2 mr-sm-2" type="number" class="form-control" id="numberOfChangeOutput" name="numberOfChangeOutput"
                                                       placeholder="Number Of Outputs">

                                                <div class="form-check mb-2 mr-sm-2">
                                                    <input data-target="send.useRandomChangeOutputs" class="form-check-input" type="checkbox" id="inlineFormCheck">
                                                    <label class="form-check-label" for="inlineFormCheck">
                                                        Use Random Amount
                                                    </label>
                                                </div>

                                                <button data-target="send.generateOutputsButton" data-action="send#generateChangeOutputs" id="generate-outputs-btn" type="button" class="btn btn-sm btn-primary btn-outline-secondary mt-0">Generate Change Outputs</button>

                                            </div>
                                        </div>
                                        <template data-target="send.changeDestinationTemplate">
                                            <div class="row">
                                                <div class="col-md-6 col-sm-12">
                                                    <div class="form-group">
                                                        <label>Change Address</label>
                                                        <input data-target="send.changeOutputAddress" type="text" class="form-control" readonly name="change-output-address" />
                                                    </div>
                                                </div>

                                                <div class="col-md-6 col-sm-12">
                                                    <div class="form-group">
                                                        <label>Amount (DCR)</label>
                                                        <input data-target="send.changeOutputAmount" type="number" class="form-control" name="change-output-amount" />
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                        <div data-target="send.changeOutputContent" id="autoChangeOutputsDiv"></div>
                                    </div>
                                  </div>
                            </div>

                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div class="errors" data-target="send.errors"></div>
                                <button data-target="send.nextButton" data-action="click->send#getWalletPassphraseAndSubmit" class="btn btn-default" id="submit-btn" type="button">Next</button>
                                <button data-action="click->send#resetSendForm" class="btn btn-danger" id="reset-btn" type="button">Reset</button>
                            </div>
                        </div>
                    </div>
               </form>
            </div>
        </div>
    </div>
    {{ template "footer" }}
    <style>
        .alert.hide-empty {
            display: none;
        }

        table {
            height: 300px !important;
            max-height: 300px !important;
        }
    </style>
</body>
</html>